import { SectionProps } from "deco/mod.ts";

const Logo = () => <svg xmlns="http://www.w3.org/2000/svg" width="77" height="33" viewBox="0 0 77 33" fill="none"><path d="M47.4398 32.5C43.7657 32.5 41.3953 31.3148 39.7361 30.0111C39.3805 30.2481 39.1435 30.4852 38.6694 30.7222C35.4694 32.3815 31.9138 32.5 30.6101 32.5C25.3953 32.5 22.6694 30.2481 21.3657 28.3519C21.2472 28.2333 21.1287 27.9963 21.0101 27.8778C18.6398 30.7222 15.5583 32.5 10.9361 32.5C6.90643 32.5 3.58791 30.9593 1.69162 28.2333C-0.323199 25.2704 -0.560236 21.2407 1.09902 16.9741C3.35088 11.2852 8.44717 7.84815 14.7287 7.84815C14.8472 7.84815 14.8472 7.84815 14.9657 7.84815C14.9657 7.72963 14.9657 7.49259 14.9657 7.37407C14.8472 5.35926 16.1509 3.58148 18.0472 2.98889L23.6175 0.855556C24.2101 0.618519 24.8027 0.5 25.3953 0.5C27.1731 0.5 28.8324 1.44815 29.662 3.10741L32.0324 7.96667C32.7435 7.84815 33.4546 7.84815 34.1657 7.84815C37.6027 7.84815 40.3287 9.03333 42.1064 11.1667C44.8324 9.03333 48.2694 7.84815 52.062 7.84815C54.0768 7.84815 55.9731 8.2037 57.3953 8.91481C57.8694 9.15185 58.3435 9.38889 58.699 9.74444C60.8324 8.55926 63.3212 7.84815 66.0472 7.84815C69.9583 7.84815 73.2768 9.38889 75.1731 12.1148C77.1879 14.9593 77.5435 18.8704 76.2398 22.7815C74.1064 28.7074 68.6546 32.5 62.2546 32.5C59.5287 32.5 57.0398 31.7889 55.1435 30.3667C54.7879 30.7222 54.3138 31.0778 53.8398 31.1963C52.062 32.0259 49.8101 32.3815 47.5583 32.5H47.4398Z" fill="#02F67C"></path><path d="M62.9658 24.6778C60.3583 24.6778 60.0028 22.1889 60.7139 19.7C61.3065 17.6852 62.8472 15.6704 65.0991 15.6704C67.825 15.6704 68.062 18.3963 67.2324 20.7667C66.7583 22.7815 65.2176 24.6778 62.9658 24.6778ZM62.2546 28.3519C66.7583 28.3519 70.6695 25.863 72.3287 21.3593C73.988 16.6186 72.0917 11.9963 66.0472 11.9963C61.188 11.9963 57.3954 15.0778 55.9732 19.1075C54.4324 23.6112 56.0917 28.3519 62.2546 28.3519ZM47.4398 28.3519C49.2176 28.3519 50.9954 27.9963 52.2991 27.4037C52.7732 26.2186 52.7732 25.0334 52.4176 23.8482C51.588 24.2038 50.2843 24.5593 49.0991 24.5593C45.662 24.5593 45.425 22.0704 46.1361 19.9371C46.9658 17.6852 48.9806 15.7889 52.1806 15.7889C53.0102 15.7889 53.8398 15.9075 54.3139 16.263C55.1435 15.0778 55.7361 13.8926 55.8546 12.7075C55.1435 12.3519 53.8398 12.1149 52.1806 12.1149C46.8472 12.1149 42.6991 15.1963 41.2769 19.463C39.7361 23.3741 40.8028 28.3519 47.4398 28.3519ZM29.188 18.6334C30.1361 16.6186 31.5583 15.4334 33.3361 15.4334C34.9954 15.4334 35.2324 16.3815 34.9954 17.0926C34.6398 18.0408 33.3361 18.6334 29.188 18.6334ZM30.7287 28.3519C32.5065 28.3519 34.8769 27.9963 36.8917 27.0482C37.2472 25.9815 37.2472 24.7963 36.7732 23.6112C35.4695 24.2037 33.6917 24.6778 32.0324 24.6778C29.6621 24.6778 28.3583 23.8482 28.3583 21.9519C34.8769 22.0704 38.3139 20.8852 39.4991 18.0408C40.5658 15.0778 38.6695 12.1149 34.1658 12.1149C29.3065 12.1149 25.7509 15.5519 24.3287 19.3445C23.025 23.2556 23.8546 28.3519 30.7287 28.3519ZM11.0546 28.3519C15.5583 28.3519 18.1658 26.3371 21.1287 19.9371C22.788 16.5 24.0917 13.063 25.7509 9.62597L27.6472 10.2186C28.1213 10.3371 28.4769 10.1 28.2398 9.62597L25.988 4.88523C25.6324 4.64819 25.2769 4.64819 25.0398 4.64819L19.3509 6.78153C18.8769 6.90005 18.8769 7.37412 19.3509 7.49264L21.1287 8.20375C19.7065 11.4037 18.0472 16.1445 16.625 19.1075C15.0843 22.426 14.2546 24.7963 11.6472 24.7963C9.03983 24.7963 8.56575 22.7815 9.63242 19.8186C10.9361 16.3815 13.0695 15.4334 15.5583 16.1445C16.2695 15.1963 16.7435 13.7741 16.9806 12.4704C16.2695 12.2334 15.4398 12.2334 14.7287 12.2334C10.6991 12.2334 6.78798 14.2482 5.12872 18.6334C2.99538 23.9667 5.0102 28.3519 11.0546 28.3519Z" fill="#113032"></path></svg>;


export async function loader(props: null, req: Request) {
    const headers: { val: string, key: string }[] = [];
    req.headers.forEach((val, key) => {
        headers.push({
            val,
            key,
        });
    });

    //const body = await req.text();

    const data = {
        headers,
        //body,
        url: req.url,
    };

    console.log("Request", req);

    return data;
}


export default function Debugger({
    headers,
    url,
}: SectionProps<typeof loader>) {
  console.log("Headers", headers);

    return (
        <div class="w-full flex flex-col items-center gap-9 p-10">
            <h1 class="flex items-center gap-2 justify-center w-full text-xl font-semibold">
                <Logo></Logo>
                <span>Proxy debugger</span>
            </h1>
            <div class="flex flex-col gap-4">
                <h4 class="font-semibold">Headers</h4>
                {headers.map(h => (
                    <p>{h.key}: {h.val}</p>
                ))}
            </div>
            <div class="flex flex-col gap-4">
                <h4 class="font-semibold">URL</h4>
                <p>{url}</p>
            </div>
        </div>
    );
}